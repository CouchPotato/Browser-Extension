function initStorage(n){var e=n;kango.storage={setItem:function(n,o,t){"undefined"!=typeof o?"function"!=typeof o&&(e[n]=o,t||this.fireEvent("setItem",{data:{name:n,value:o}})):this.removeItem(n)},getItem:function(n){return"undefined"!=typeof e[n]?e[n]:null},removeItem:function(n,o){delete e[n],o||this.fireEvent("removeItem",{data:{name:n}})},getKeys:function(){var n=[];for(var o in e)e.hasOwnProperty(o)&&n.push(o);return n},clear:function(n){e={},n||this.fireEvent("clear")}},object.mixin(kango.storage,EventTarget.prototype),object.mixin(kango.storage,new EventTarget),StorageSyncModule(kango.storage,func.bind(kango.addEventListener,kango),func.bind(kango.dispatchMessage,kango))}function initI18n(n,e){var o=e;kango.i18n={getMessages:function(){return o},getMessage:function(n){var e=o[n]?o[n]:n;return arguments.length>1?string.format.apply(string,[e].concat(Array.prototype.slice.call(arguments,1))):e},getCurrentLocale:function(){return n}}}function initApi(){initMessaging();var n=new MessageTargetModule(func.bind(kango.addEventListener,kango));kango.addMessageListener=func.bind(n.addMessageListener,n),kango.removeMessageListener=func.bind(n.removeMessageListener,n);var e=new InvokeAsyncModule(func.bind(kango.addEventListener,kango),func.bind(kango.dispatchMessage,kango),null,func.bind(kango.console.log,kango.console));kango.invokeAsync=e.invokeAsync,kango.invokeAsyncCallback=e.invokeAsyncCallback,kango.invokeAsync("modules/kango/extension_info/getRawData",function(n){kango.getExtensionInfo=function(){return n},kango.invokeAsync("modules/kango/storage/storage.getItems",function(n){initStorage(n),kango.invokeAsync("modules/kango/i18n/getCurrentLocale",function(n){kango.invokeAsync("modules/kango/i18n/getMessages",function(e){initI18n(n,e),apiReady.fire()})})})})}var kango=window.kango={};kango.lang={evalInSandbox:function(n,e,o){new Function(e+"\n//# sourceURL=sandboxed-"+o+".js")()},evalScriptsInSandbox:function(n,e,o){for(var t="",a=0;a<e.length;a++){for(var r=0;r<e[a].requires.length;r++)t+=e[a].requires[r].text+"\n\n";t+=e[a].text+"\n\n"}return this.evalInSandbox(n,t,o)}},kango.console={log:function(n){console.log(n)},warn:function(n){console.warn(n)},error:function(n){console.error(n)}},kango.tab={isPrivate:function(){return!1}},kango.xhr={send:function(n,e){var o=n.contentType;("xml"==o||"json"==o)&&(n.contentType="text"),n.sanitizeData=!0,kango.invokeAsyncCallback("kango.xhr.send",n,function(t){if(""!=t.response&&null!=t.response)if("json"==o)try{t.response=JSON.parse(t.response)}catch(a){t.response=null}else if("xml"==o)try{var r=new DOMParser;t.response=r.parseFromString(t.response,"text/xml")}catch(a){t.response=null}n.contentType=o,e(t)})}};var apiReady=function(){var n=!1,e=[];return{on:function(o){n?o():e.push(o)},fire:function(){n=!0,array.forEach(e,function(n){n()}),e=[]}}}();